---
title: 公共头尾
date: 2021-04-15 16:00:53
permalink: /pages/211cb4/
categories:
  - 内部文档
  - 商场文档
tags:
  - 
---
## 文件位置
1. 动态模板：https://code.ds.gome.com.cn/svn/atg_poc/30_Coding/NewDevMode/trunk/gome-gfe/components-web/public
2.	静态文件：测试测uat，pre不需要测但需要把代码合到pre，为的是方便增量提取发版，发ui.png时需要把图片压缩一下
    * uat：https://code.ds.gome.com.cn/svn/atg_poc/30_Coding/pangu/uat/storefront/j2ee-apps/Storefront/storedocroot.war/gmpro/1.0.0/public/1.0.0
    * pre：https://code.ds.gome.com.cn/svn/atg_poc/30_Coding/pangu/pre/storefront/j2ee-apps/Storefront/storedocroot.war/gmpro/1.0.0/public/1.0.0


## 发版

1. 静态文件发版
  * uat发版：http://10.58.22.45:8080/view/uat.ear.restart/job/uat.staticFile.restart/
  * 4344和生产发版：把uat的代码合并到pre上；合到pre是为了方便拉取代码。增量发版

  从改的路径里先导出文件，里面会带有路径这样，就少创建文件，路径是从下面的目录开始的
  ![/img/headfoot/32.png](/img/headfoot/32.png)
  ![/img/headfoot/33.png](/img/headfoot/33.png)
  - [发版地址](http://10.58.62.115:8080)
  - 账号：duanning 
  - 密码：duanning@fly
  - [stage-web发版生产](http://10.58.62.115:8080/job/live-pc-front)
  - [stage-web发版4344](http://10.58.62.115:8080/job/4344-pc-front/)
  > 注：stage-web发版需要打zip包，要对应好路径

2. 动态模板：用gfe发版，http://gui.ds.gome.com.cn:8080/#/task/taskList
  * 应用名：components-web  后端版本号：生产：1.0.1.1；uat: 1.0.2.1
  * 发uat、生产，用gfe-app去发。发完后需要去ERM里去生成-预览-发布

## 发版后头尾生成
![/img/headfoot/3.png](/img/headfoot/3.png)

![/img/headfoot/4.png](/img/headfoot/4.png)

![/img/headfoot/5.png](/img/headfoot/5.png)

![/img/headfoot/6.png](/img/headfoot/6.png)

## 模板预览地址
* uat：http://gccpreview.ds.atguat.com.cn/ngcc/preview/**b06**/preview.html
* 生产：http://gccpreview.ds.gome.com.cn/ngcc/preview/**a20**/preview.html
> 注：加粗表示方案号，如果这个页访问地址有问题找段翠英，如果是里面的广告有问题找段翠英

## 查看公共同步数据（数据负责人：徐航）

每次变的时候只需要把方案名变一下就是type的值换成对应的方案号，尽量用域名的哪个查看吧，ip的有可能变了

uat地址：
* http://10.115.3.60:3260/view/public/head.jsp?type=default&data=1
* http://preview.ds.atguat.com.cn/components/public/aside.jsp?type=b15&data=1


生产地址：
* http://10.58.62.89:3260/view/public/head.jsp?type=b09&data=1
* http://preview.ds.gome.com.cn/components/public/head.jsp?type=b09&data=1

## 动态页模板地址
模板预览页如果模板写的有问题，可以查看这，出问题会报红：
view-source:http://preview.ds.atguat.com.cn/components/public/global.jsp

http://preview.ds.atguat.com.cn/components/public/head.jsp?type=b15

## 静态化后的模板地址
http://preview.ds.gome.com.cn/n/common/b14/head.html

http://www.atguat.com.cn/n/common/global/head_mygome.html

http://www.atguat.com.cn/n/common/b15/head.html

## 头尾后端接口对接人
* 侧边栏： 石佳伟
* 登陆会员：戚辉永 
* 我的收藏：于麒鹏

## ERM系统配置以及用户名和密码
* uat：网址：http://erm.atguat.com.cn/main.action  用户名/密码：ermadmin2/aAbb2e33
* 生产：网址：http://erm.ds.gome.com.cn/  用户名/密码：头尾生成用liusuling/域账号密码 linlin /Gome@1234 LSL180301/ Lsl123456
* 广告系统的生产账号：qiaolu/123.gome （从来没用过，先放这）

## 测试
1.	静态文件测试
  * 全局安装gmodjs，具体参考：https://github.com/midday/gmodjs，tpl里的文件如有修改则需在有gmodjs-config.json的文件里运行gmod命令,会自动在js里生成对应的xx-tpl.js。
  * 全局安装gfe-proxy，具体参考：https://github.com/midday/gfe-proxy，如要调试某一文件，需要修改gfe-proxy-config.json里

  ``` js
  "cssMountFolder": "css",
  "cssUrlUniqueSubstr": "gmpro/1.0.0/public/1.0.0/css/top.min.css",
  "jsMountFolder": "js",
  "jsUrlUniqueSubstr": "gmpro/2.0.0/"
  ```
  > 注：如果域名是https是不能代理的。如果开了其他的代理需要关闭其它的代理。

2. 动态模板测试
  * 在html文件里新建一个文件，或在test目录下，如foot-test.ftl，再引用公共的头尾css和js,包括head,body等常用的html标签的头尾。
  * 在文件里引用要调试的模板，如引用<#include "foot.ftl" />
  * 在data文件里新建一个foot-test.json的文件，此文件名要跟html文件里建的文件名一致，如果要测试头部就将头部的同步数据放入文件，如果要测试尾部就将尾部的数据放入文件。
  * 启动gfe b -o 即可调试
  > 注：此调试需要安装jdk,并配置环境变量，参考：http://cache.baiducontent.com/c?m=9d78d513d99b17f64fece4697d66c0161c43f0142ba7d1027ea4843890732c475017e0ac57560705a3d20d6016d84f4b9cf42103361767f7c5c7d20c9bf985295c953a6c2b40d30a418f0eafbc16769a76d74de9d848bae5ed61d3e8898281034ecb57047085f0dc0b5610ca3bf74035b4a0c91b165b44ebbd276588033176c1&p=8536c64ad4981aeb03bd9b7e0d1496&newp=83769a4786cc41af5afcc264534397231610db2151d6d2136b82c825d7331b001c3bbfb423241604d9c178650aa84e5aeff035793c072ba3dda5c91d9fb4c57479&user=baidu&fm=sc&query=jdk%BB%B7%BE%B3%B1%E4%C1%BF%C5%E4%D6%C3&qid=e52b0cf10000db57&p1=3；再运行java查看是否安装好


## 公共头尾4344 HOST 4344因为头尾生成有问题很久没再更新 （可能不是最新的了，如果不对可以问问部署）
``` js
  10.58.22.28 ngcc.ds.gome.com.cn 
	10.58.22.28 gccpreview.ds.gome.com.cn
	10.58.22.28 preview.ds.gome.com.cn
	10.58.24.110 www.gome.com.cn

  可能换成了
  10.105.4.25 ngcc.ds.gome.com.cn 
	10.105.4.25 gccpreview.ds.gome.com.cn
	10.105.4.25 preview.ds.gome.com.cn
	10.105.4.25 www.gome.com.cn
```

## 前端界面查看方案号
在网站导航链接标签上查看公共头尾方案号data-type="a34"


## 打包后的包路径
[http://bin.ds.gome.com.cn/atg_poc/gome-feapp/uat/components-web/](http://bin.ds.gome.com.cn/atg_poc/gome-feapp/uat/components-web/)
## 登陆信息代码
``` js
//window.loginData.loginStatus:三种状态，1表示未登录，2表示假登陆，3表示已登录 
if (window.loginData.loginStatus > 1) { 
	//此处调用代码 
} else { //拉取用户，确保loginId存在 
	window.signData.login({}, function(data) { 
	window.signData.setLoginStyle(data);
	//此处调用代码 
}

```
## 增加频道里的模板
如果跟主站的不一样：
* 静态的文件，如果是部门自己的代码，模板可以放在public下面，由自己开发，静态的文件，自己负责，统一放在https://code.ds.gome.com.cn/svn/atg_poc/30_Coding/pangu/uat/storefront/j2ee-apps/Storefront/storedocroot.war/gmpro/1.0.0/public下，自己新建文件，我们帮配置，具体可参考汽车：https://car.gome.com.cn/?intcmp=sy-1000000378-7

* 如果频道里某个模块要增加需要后端增加对应的序号，具体操作可参考 **频道模板配置**，新增

需要后端开发对应模块，配置数据，和对应的编号

## 频道模板配置
频道模板配置：当需要新增某一选项时需要我们自己配

![/img/headfoot/7.png](/img/headfoot/7.png)

![/img/headfoot/8.png](/img/headfoot/8.png)

![/img/headfoot/9.png](/img/headfoot/9.png)

![/img/headfoot/10.png](/img/headfoot/10.png)

> 如需增加，需要和后端协商序号，新增的序号需要和后端关联
> 注：新增要把该处用到的js和css都引进去，新增或修改后需要产品授权方能使用，具体的新增可以参照其他的方案

* 广告系统，产品配置，可以在分组名称里搜如default,a01等 (这个之前是段翠英搞的，我这这是记录一下，不是前端配置)

  ![/img/headfoot/11.png](/img/headfoot/11.png)

  新增广告时：负责publica关键字，可以参考其它已经建立好的广告。
  1.	从编辑里复制html模板和预览模板的内容，只分组名称和关键字不一样配置就行。
  2.	可以在广告方案和广告内容里具体配置


## 头尾同步数据的配置
大部分在公共头尾方案管理里，头部导航数据在下面的位置搜索
> 注：default方案是在全部分类下配置，同步数据过来的需要生成一下，二级分类是异步数据过来的不需要生成

![/img/headfoot/1.png](/img/headfoot/1.png)

![/img/headfoot/27.png](/img/headfoot/27.png)

## 公共头尾方案管理权限的配置
![/img/headfoot/28.png](/img/headfoot/28.png)

![/img/headfoot/29.png](/img/headfoot/29.png)
## GUI地址
http://10.115.0.147/

主要看里面的说明文档公共头尾非modelid埋码一览表和新版公共头尾引用说明，如果有人不会使用，就告诉他去这看

* 埋码：http://10.115.0.147/?src=/page-17-28.html
  1.	顶通增加：我的美店：public01060

* 新版头尾的引用说明：http://10.115.0.147/?src=/page-17-28.html
* 头尾依赖文件：http://10.115.0.147/?src=/page-17-28.html


## 广告系统埋规则
三段  下线  +中 线：例：publicdefault_category-1，如不对找段翠英

## 连uat服务器看公共头尾和广告静态页 很多年前没动，不知道变了没，没用过
ip：10.58.56.145			用户名/密码：gome_guest/ searchlog678!

地址：/app/weblogic/upload/prodhtml/statichtml/index/n/common/ads/publica01

## 常见问题
* 广告系统（需要产品授权，如果授权了有问题，可以找段翠英看看）
  广告数据，只需要publicdefault变成对应的方案号，如a01对应的是publica01：view-source:http://www.atguat.com.cn/n/common/ads/publicdefault/index.html
  1.	新建方案无数据：uat/gccweb 4344环境，停用再启用一下分组方案，原因可能是因为配置的延迟。点击广告系统里的分组列表里的点击编辑按钮下有停用启用，实在不行点击广告内容里的终止
  2.	如果广告没显示，查数据，看广告系统的配置是否正常，是发布状态还是停用状态
  3.	比如页面顶部出现一到两个404，首先看源码定位到是广告html 404的话，基本断定是文件同步问题，找段翠英或者部署来处理
* erm头尾问题
  1.	erm里生成时如果有问题一般找段翠英
  2.	点击生成公共头尾时报错，报如下的错误需重发channel-web，或者找徐航，弹窗里错误提示有stage-web找徐航
  ![/img/headfoot/23.png](/img/headfoot/23.png)

  3. 如果是以下问题，可以先输入动态页模板地址查看，是否是自己的代码错误，或者是后台某变量没传，如果不是自己的原因可以找段翠英，数据不对找徐航
  ![/img/headfoot/24.png](/img/headfoot/24.png)
  4. 点击统一生成失败，找段翠英
  5.	help.atguat.com.cn，改了发uat不管用，是因为这个需要配host，具体的找段翠英
  6.	国美快讯头尾问题，可以先看模板页http://news.atguat.com.cn/stage-web/news/news.jsp?type=homepage&page=1&ftlPath=news/news_gome
  7.	如果访问//gccpreview.ds.gome.com.cn/ngcc/preview/a54eview.html错误，需要逐个排查它引用的头尾文件，如查到同目录下的文件只有http://www.atguat.com.cn/n/common/a54/head.html错误，可以动态页http://10.58.62.89:3040/public/head.jsp?type=a54，看一下广告引用是否没ssi解析，如果没有再继续查看广告有问题找段翠英，如不是广告的问题则找段翠英，部署
* 4344
  * 如果uat和生产的代码是对的，4344不对，可以看下面的红色处，有些页面uat和生产需要先生产静态页，它的版本号会是不变，如果代码没变过来，可以看这个地方的日期http://www.gome.com.cn/n/common/a11/script.html
  ![/img/headfoot/25.png](/img/headfoot/25.png)

## 搭建svn分支  做参考用，因为这个是参照channel-web
![/img/headfoot/20.png](/img/headfoot/20.png)

![/img/headfoot/21.png](/img/headfoot/21.png)

![/img/headfoot/22.png](/img/headfoot/22.png)

## 注
1.	首页的广告首页自己负责
2.	小购物车代码相关代码，购物车人员负责

## 全站图片需要我们更换
换的时候找到对应的路径进行更换
``` js
http://css.gomein.net.cn/images/ui/noimg.jpg 
http://css.gomein.net.cn/images/ui/gomelogo.png 
http://css.gomein.net.cn/images/ui/gomelogo_195x40.png 
http://css.gomein.net.cn/images/ui/gomelogo_200x43.png 
http://css.gomein.net.cn/images/ui/gomelogoW.png 
http://css.gomein.net.cn/images/gome-logoico.png 
http://css.gomein.net.cn/gmpro/1.0.0/survey/1.0.0/images/logo_02.png  此处现在我们不负责，由段翠英负责
http://css.gomein.net.cn/gmpro/1.0.0/gofreshTwo/1.0.0/css/i/new_logo.png 
http://css.gomein.net.cn/f2eimage/stage/appdown/appdown/gome-logo.png 
http://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading.png 
http://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading.gif 
http://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading-sm.png

```
以上是部分整体的，以下是常换的,都从https://code.ds.gome.com.cn/svn/atg_poc/30_Coding/pangu/uat/storefront/j2ee-apps/Storefront/storedocroot.war/这个根下开始找

``` js
图片地址：http://css.gomein.net.cn/images/ui/gomelogo.png 
图片尺寸：168*50
图片地址：http://css.gomein.net.cn/images/ui/gomelogo_195x40.png 
图片尺寸：195*40
图片地址：http://css.gomein.net.cn/images/ui/gomelogo_200x43.png 
图片尺寸：200*43
图片地址：http://css.gomein.net.cn/images/ui/gomelogoW.png 
图片尺寸：167*48
图片地址：http://css.gomein.net.cn/images/gome-logoico.png 
图片尺寸：168*50
图片地址：http://css.gomein.net.cn/gmpro/1.0.0/gofreshTwo/1.0.0/css/i/new_logo.png 
图片尺寸：210*70
图片地址：http://css.gomein.net.cn/f2eimage/stage/appdown/appdown/gome-logo.png 
图片尺寸：167*48
图片地址：http://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading-sm.png
图片尺寸：80*24

```

icon://app.gomein.net.cn/favicon.ico

f2eimage/ui下面的：http://css.atguat.com.cn/f2eimage/ui/ui.png不止这一个，参考链接http://caipiao.gome.com.cn/index.html

iconfont ：gmlib\ui\iconfont\1.0.0由我们负责，这个清缓存需要找部署，我们清不干净

``` js
真划算：	https://tuan.gome.com.cn/?intcmp=sy-1000000378-2
	G:\GOME-GFE\cheap-web\groupon\css\i\common
商家入驻：https://www.gome.com.cn/join/?intcmp=null-1000043124-11
	G:\GOME-GFE\single-web\merchantJoin\css\i
招聘：	https://zp.gome.com.cn?intcmp=null-1000043124-11
	G:\GOME-CDN\uat\gmpro\1.0.0\zp\1.0.0\images
公司简介：https://help.gome.com.cn/about/company.html?intcmp=null-1000043124-2
	G:\GOME-CDN\uat\gmpro\1.0.0\helpcenter\1.0.1\images\old\about\banner
服务中心：https://help.gome.com.cn/bzfw?intcmp=sy-1000060797-5
	https://help.gome.com.cn/question/6594.html?intcmp=sy-public01027
	G:\GOME-CDN\uat\gmpro\1.0.0\helpcenter\1.0.0\images
	G:\GOME-CDN\uat\gmpro\1.0.0\helpcenter\1.0.1\images
商家服务中心：http://help.gome.com.cn/sj
	G:\GOME-GFE\channel-web\sellerHelp\css\i
商家培训中心：https://px.gome.com.cn/?intcmp=shopBrought-public01034
	G:\GOME-CDN\uat\gmpro\1.0.0\sellertrain\1.0.0\images
以下页面不在我这：
https://wt.gome.com.cn/recharge/index.html?intcmp=sy-1000037040-1 国立新
	https://pop.gome.com.cn/?intcmp=help-public01031  pop 李吴东 代码不在我们这
	https://amp.gome.com.cn/home?intcmp=shopBrought-public01032 朱礼斌
	http://cps.gome.com.cn/?intcmp=sy-1000043124-10 朱礼斌

```

## 清缓存
清缓存地址：http://cache.ds.gome.com.cn/toLogin，用户名和密码： gome/gome_123

如果是后加载的js一定要手动清缓存，比喻http://js.gomein.net.cn/gmpro/1.0.0/public/1.0.0/js/aside-tpl.min.js，是在鼠标移到侧栏某个标签上才调用的

头尾常用logo：

http://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/logo.png; http://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/ui.png;http://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/overseas_logo.png;https://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/logo.png;https://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/ui.png;https://css.gomein.net.cn/gmpro/1.0.0/public/1.0.0/css/i/overseas_logo.png

静态图片

http://css.gomein.net.cn/images/ui/gomelogo.png;http://css.gomein.net.cn/images/ui/gomelogo_195x40.png;http://css.gomein.net.cn/images/ui/gomelogo_200x43.png;http://css.gomein.net.cn/images/ui/gomelogoW.png;http://css.gomein.net.cn/images/gome-logoico.png;http://css.gomein.net.cn/gmpro/1.0.0/gofreshTwo/1.0.0/css/i/new_logo.png;http://css.gomein.net.cn/f2eimage/stage/appdown/appdown/gome-logo.png;http://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading-sm.png;http://css.atguat.com.cn/f2eimage/ui/ui.png;http://css.atguat.com.cn/f2eimage/ui/customer_service_weixin.jpg;http://css.atguat.com.cn/f2eimage/ui/ui.gif;http://app.gomein.net.cn/favicon.ico;https://css.gomein.net.cn/images/ui/gomelogo.png;https://css.gomein.net.cn/images/ui/gomelogo_195x40.png;https://css.gomein.net.cn/images/ui/gomelogo_200x43.png;https://css.gomein.net.cn/images/ui/gomelogoW.png;https://css.gomein.net.cn/images/gome-logoico.png;https://css.gomein.net.cn/gmpro/1.0.0/gofreshTwo/1.0.0/css/i/new_logo.png;https://css.gomein.net.cn/f2eimage/stage/appdown/appdown/gome-logo.png;https://css.gomein.net.cn/gmlib/ui/loading/3.0.0/loading-sm.png;https://css.atguat.com.cn/f2eimage/ui/ui.png;https://css.atguat.com.cn/f2eimage/ui/customer_service_weixin.jpg;https://css.atguat.com.cn/f2eimage/ui/ui.gif;https://app.gomein.net.cn/favicon.ico

## 压图地址
[https://tinypng.com/](https://tinypng.com/)

## 新项目配公共头尾

需要发邮件给部署，参考如下：
把域名下配上ssi解析
微海报项目的域名需要同步新版头尾，麻烦帮做一下相关配置：
* uat测试环境： wposter.atguat.com.cn/
* 生产环境：    wposter.gome.com.cn/


以下是参考，如果部署不会的告诉他
```js
server {
    listen 80;
    server_name  zp.gome.com.cn ;
    include /app/tengine/conf/gome.common.https.conf;

    location ~ ^/n/common/ {
        proxy_redirect off;
        proxy_pass  http://static.gome.com.cn;
    }

    location ~ ^\/glogin_callback\.html {
        proxy_redirect off;
        proxy_pass  http://static.gome.com.cn;
    }

    location / {
        root /app/web_root/staticpage/zp;
        index index.html;
    }

    access_log /app/tengine_log/logs/ zp.gome.com.cn.gelk.access.log mainhttps;
    error_log /app/tengine_log/logs/ zp.gome.com.cn.gelk.error.log error;
}

//在nginx里配置这部分就可以
location ~ ^/n/common/ {
    proxy_redirect off;
    proxy_pass  http://static.gome.com.cn;
}

location ~ ^\/glogin_callback\.html {
    proxy_redirect off;
    proxy_pass  http://static.gome.com.cn;
}

```

## 一些网站的账号
* uat账号：
			testhanxiying/a111111
			testhanxiying2/a111111
			testhanxiying3/a111111
			testhanxiying4/a111111
* 企业购uat：
			testhxyqyg/a111111
			qy20160324001/ sc2016
* 生产账号：
		hanxiying@yolo24.com/hxy416gcc73
* 生产企业账号：
		dakehuybzh/yanbaozhihuan

## 首页静态页生成
[http://gcc.ds.atguat.com.cn/gcc/promotion/staticPage_getIndexStaticHtml.do](http://gcc.ds.atguat.com.cn/gcc/promotion/staticPage_getIndexStaticHtml.do)

![/img/headfoot/30.png](/img/headfoot/30.png)

## 代理
![/img/headfoot/31.png](/img/headfoot/31.png)

config里面加这个就行了, target 后端ip  keywords 请求路径关键字儿, 配host fx.atguat.com.cn  127.0.0.1